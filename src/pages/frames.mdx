import Gallery from '@browniebroke/gatsby-image-gallery';
import SEO from '../components/seo';
import { graphql } from 'gatsby';

export const query = graphql`
  query {
    allInstaNode {
      edges {
        node {
          id
          likes
          comments
          mediaType
          preview
          original
          timestamp
          caption
          localFile {
            childImageSharp {
              thumb: fluid(maxWidth: 500, maxHeight: 400) {
                ...GatsbyImageSharpFluid
                originalName
              }
              full: fluid(maxWidth: 1024) {
                ...GatsbyImageSharpFluid
              }
            }
          }
        }
      }
    }
  }
`;

<SEO title="Frames" />

<h1>
  Latest{' '}
  {
    props.data.allInstaNode.edges.filter(
      ({ node }) => node.mediaType === 'GraphSidecar'
    ).length
  }
</h1>

Find more at [Instagram][]

<Gallery
  images={props.data.allInstaNode.edges
    .filter(({ node }) => node.mediaType === 'GraphSidecar')
    .map(({ node }) => ({
      ...node.localFile.childImageSharp,
      caption: node.caption,
      thumbAlt: node.name,
    }))}
/>

[instagram]: https://www.instagram.com/ahmad.atallah/
